# BitNet

비트넷은 

기사:
https://www.popsci.co.kr/news/articleView.html?idxno=22875
https://news.hada.io/topic?id=20406

논문: https://arxiv.org/pdf/2410.16144
논문 환경
* CPU: Intel Core i7-13700H processor (14 cores, 20 threads)
* RAM: 64GB

내 PC 환경
* CPU: Intel® Core™ i7-1360P Processor (12 cores, 16 threads)
* RAM: 32GB
* OS: Windows 11 Pro, 64bit

1. 아나콘다 설치
    1. 설치 시 콘다를 Windows PATH 등록할 것
2. Visual Studio 2022 설치 (커뮤니티 버전 기준)
    1. 프로페셔널 등 다른 버전은 아래 모든 내용에서 Visual Studio 2022 설치 경로만 프로페셔널 버전 설치 경로로 변경
3. https://github.com/microsoft/BitNet?tab=readme-ov-file: Build from source 진행
    1. Clone the repo 진행
    2. VSC: CMake: Select a Kit:에서 Clang 19.1.1 (MSVC CLI) - x86 for MSVC 17.x.x 선택
        1. build 폴더 설정을 VSC가 진행하면서 src/CMakeLists.txt 오류 사라짐
    3. Install the dependencies
        1. conda create -n bitnet-cpp python=3.9
        2. VSC: Select Interpreter for Python: bitnet-cpp로 Python interpreter 변경
        3. 이후 단계 진행
    4. Build the project
        1. huggingface-cli download microsoft/BitNet-b1.58-2B-4T-gguf --local-dir models/BitNet-b1.58-2B-4T 진행
        2. Import-Module "C:\Program Files\Microsoft Visual Studio\2022\Community\Common7\Tools\Microsoft.VisualStudio.DevShell.dll"
        3. Enter-VsDevShell -SkipAutomaticLocation -DevCmdArguments "-arch=x64 -host_arch=x64"
        4. clang -v
            1. clang 버전이 잘 잡히는 등 아래와 같이 나타나야함: ```clang version 19.1.1 \ Target: x86_64-pc-windows-msvc \ ...```
        5. 서브모듈 업데이트: git submodule update --remote --merge 3rdparty/llama.cpp 
        6. 서브모듈 디버깅: 다음 파일에 #include <chrono> 추가
            1. 3rdparty\llama.cpp/common/common.cpp
            2. 3rdparty\llama.cpp/common/log.cpp
            3. 3rdparty\llama.cpp\examples\imatrix\imatrix.cpp
            4. 3rdparty\llama.cpp\examples\imatrix\imatrix.cpp
            5. 3rdparty\llama.cpp\examples\perplexity\perplexity.cpp
        7. 빌드 실행
            1. python setup_env.py -md models/BitNet-b1.58-2B-4T -q i2_s
        8. 대화 모드로 실행 가능 확인
            1. python run_inference.py -m models/BitNet-b1.58-2B-4T/ggml-model-i2_s.gguf -p "You are a helpful assistant" -cnv